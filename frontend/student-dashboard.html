<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Dashboard - InRent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      /* Custom styles to complement Tailwind */
      body {
        font-family: 'Inter', sans-serif; /* Default body font */
        background-color: #f0f2f5; /* Light gray background */
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: 'Poppins', sans-serif; /* Headings use Poppins */
      }
      /* Custom scrollbar for main content */
      .main-content::-webkit-scrollbar {
        width: 8px;
      }
      .main-content::-webkit-scrollbar-track {
        background: #e2e8f0; /* Light blue-gray */
        border-radius: 10px;
      }
      .main-content::-webkit-scrollbar-thumb {
        background: #94a3b8; /* Slate gray */
        border-radius: 10px;
      }
      .main-content::-webkit-scrollbar-thumb:hover {
        background: #64748b; /* Darker slate gray */
      }
      @media (max-width: 900px) {
        body,
        .centered-form-container,
        .main-content,
        .container,
        form {
          min-width: 90vw !important;
          max-width: 95vw !important;
          padding: 1.5rem 0.5rem !important;
        }
      }
      @media (max-width: 600px) {
        body,
        .centered-form-container,
        .main-content,
        .container,
        form {
          min-width: 100vw !important;
          max-width: 100vw !important;
          padding: 1.2rem 0.5rem !important;
          border-radius: 0 !important;
          box-shadow: none !important;
        }
        label,
        input,
        select,
        button,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
          font-size: 1.1rem !important;
        }
      }
      @media (max-width: 400px) {
        body,
        .centered-form-container,
        .main-content,
        .container,
        form {
          padding: 0.5rem 0.2rem !important;
        }
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
          font-size: 1.2rem !important;
        }
      }
    </style>
  </head>
  <body class="min-h-screen flex flex-col">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script>
      // For security, do NOT expose your entire Firebase config if this is public facing.
      // Use Firebase Hosting or Cloud Functions for more secure setup if needed.
      const firebaseConfig = {
        apiKey: "AIzaSyAXKk5gRjwSGK_g9f_HP_f4y4445e_8l4w",
        authDomain: "project-1-1e31c.firebaseapp.com",
        projectId: "project-1-1e31c",
        storageBucket: "project-1-1e31c.firebasestorage.app",
        messagingSenderId: "658275930203",
        appId: "1:658275930203:web:afc2e2a249509737b0ef7e",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore(); // If you're using Firestore
    </script>

    <script>
      // Existing API_BASE for non-Firebase specific calls (like properties, if they are separate)
      const API_BASE = "https://project-1-2alx.onrender.com"; // Keep if you still have a separate REST API

      // --- Firebase-based Authentication & Role Check ---
      auth.onAuthStateChanged(async (user) => {
        if (user) {
          // User is signed in. Get their custom claims.
          try {
            const idTokenResult = await user.getIdTokenResult(true); // true to force refresh
            const userRole = idTokenResult.claims.role; // Assuming 'role' is a custom claim

            if (userRole === "student") {
              // User is a student, proceed with loading student dashboard data
              await fetchUserProfile(user); // Pass Firebase user object
              await fetchDashboardStats(user); // Pass Firebase user object
              await fetchProperties(); // This might still use your REST API or Firebase DB
              await fetchReviews(); // This might still use your REST API or Firebase DB
            } else if (userRole === "landlord") {
              // User is a landlord, redirect to landlord dashboard
              window.location.href = "landlord-dashboard.html";
            } else {
              // User is authenticated but has an unknown or no role
              console.warn("Authenticated user with unknown role:", userRole);
              auth.signOut(); // Log them out
              window.location.href = "login.html";
            }
          } catch (error) {
            console.error("Error getting user claims:", error);
            auth.signOut(); // Log out on error
            window.location.href = "login.html";
          }
        } else {
          // User is not signed in, redirect to login page
          window.location.href = "login.html";
        }
      });

      // --- Modified fetchUserProfile to use Firebase user object ---
      async function fetchUserProfile(firebaseUser) {
        if (!firebaseUser) return; // Ensure user object is passed

        try {
          // You might fetch additional profile details from Firestore/Realtime DB
          // For now, let's use what's available from Firebase Auth or a user profile collection
          const userDoc = await db.collection("users").doc(firebaseUser.uid).get();
          const userData = userDoc.exists ? userDoc.data() : {};

          document.getElementById("sidebarWelcome").textContent = `Welcome, ${
            userData.firstName || firebaseUser.displayName || "Student"
          }`;
          const profileImageUrl =
            userData.profilePictureUrl ||
            firebaseUser.photoURL ||
            "https://placehold.co/80x80/16A34A/FFFFFF?text=S";
          document.querySelector(".sidebar-header .profile-image").src =
            profileImageUrl;
          document.querySelector(".profile-menu .profile-image-small").src =
            profileImageUrl;
        } catch (error) {
          console.error("Failed to fetch user profile from Firestore:", error);
          // Fallback to basic Firebase Auth info
          document.getElementById("sidebarWelcome").textContent = `Welcome, ${
            firebaseUser.displayName || "Student"
          }`;
          const profileImageUrl =
            firebaseUser.photoURL ||
            "https://placehold.co/80x80/16A34A/FFFFFF?text=S";
          document.querySelector(".sidebar-header .profile-image").src =
            profileImageUrl;
          document.querySelector(".profile-menu .profile-image-small").src =
            profileImageUrl;
        }
      }

      // --- fetchDashboardStats, fetchProperties, fetchReviews ---
      // These functions would now typically fetch data from Firestore/Realtime DB
      // instead of a separate REST API, if your data is entirely in Firebase.
      // If your "recommended properties" are complex and involve server-side logic,
      // you might still use Firebase Cloud Functions for that.
      // For demonstration, I'll show how you *could* fetch from Firestore.

      async function fetchDashboardStats(firebaseUser) {
        if (!firebaseUser) return;
        try {
          // Example: Fetch stats from a 'userStats' collection or aggregated data
          const statsDoc = await db.collection("userStats").doc(firebaseUser.uid).get();
          const stats = statsDoc.exists ? statsDoc.data() : {
            savedProperties: 0,
            scheduledViewings: 0,
            unreadMessages: 0,
            reviewsCount: 0
          };

          const dashboardCardsContainer =
            document.getElementById("dashboardCards");
          dashboardCardsContainer.innerHTML = `
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center transform hover:scale-105 transition-transform duration-200">
              <h3 class="text-lg font-semibold text-gray-700 mb-2"><i class="fas fa-heart text-red-500 mr-2"></i> Saved Properties</h3>
              <p class="text-4xl font-bold text-gray-900">${
                stats.savedProperties || 0
              }</p>
            </div>
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center transform hover:scale-105 transition-transform duration-200">
              <h3 class="text-lg font-semibold text-gray-700 mb-2"><i class="fas fa-calendar text-blue-500 mr-2"></i> Scheduled Viewings</h3>
              <p class="text-4xl font-bold text-gray-900">${
                stats.scheduledViewings || 0
              }</p>
            </div>
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center transform hover:scale-105 transition-transform duration-200">
              <h3 class="text-lg font-semibold text-gray-700 mb-2">
                <i class="fas fa-envelope text-green-500 mr-2"></i> Messages
                <span class="notification-asterisk text-red-500 text-xl font-bold">${
                  stats.unreadMessages > 0 ? "*" : ""
                }</span>
              </h3>
              <p class="text-4xl font-bold text-gray-900">${
                stats.unreadMessages || 0
              }</p>
            </div>
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center transform hover:scale-105 transition-transform duration-200">
              <h3 class="text-lg font-semibold text-gray-700 mb-2"><i class="fas fa-star text-yellow-500 mr-2"></i> Reviews</h3>
              <p class="text-4xl font-bold text-gray-900">${
                stats.reviewsCount || 0
              }</p>
            </div>
          `;
          document.getElementById("notificationBadge").textContent =
            stats.unreadMessages || 0;
        } catch (error) {
          console.error("Failed to fetch dashboard stats from Firebase:", error);
          // Render default cards if fetching fails
          document.getElementById("dashboardCards").innerHTML = `
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center">
              <h3 class="text-lg font-semibold text-gray-700 mb-2"><i class="fas fa-heart text-red-500 mr-2"></i> Saved Properties</h3>
              <p class="text-4xl font-bold text-gray-900">N/A</p>
            </div>
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center">
              <h3 class="text-lg font-semibold text-gray-700 mb-2"><i class="fas fa-calendar text-blue-500 mr-2"></i> Scheduled Viewings</h3>
              <p class="text-4xl font-bold text-gray-900">N/A</p>
            </div>
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center">
              <h3 class="text-lg font-semibold text-gray-700 mb-2">
                <i class="fas fa-envelope text-green-500 mr-2"></i> Messages
                <span class="notification-asterisk text-red-500 text-xl font-bold"></span>
              </h3>
              <p class="text-4xl font-bold text-gray-900">N/A</p>
            </div>
            <div class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center">
              <h3 class="text-lg font-semibold text-gray-700 mb-2"><i class="fas fa-star text-yellow-500 mr-2"></i> Reviews</h3>
              <p class="text-4xl font-bold text-gray-900">N/A</p>
            </div>
          `;
        }
      }

      async function fetchProperties() {
        try {
          // Example: Fetch properties from a 'properties' collection in Firestore
          const propertiesSnapshot = await db.collection("properties").where("recommended", "==", true).limit(9).get();
          const properties = propertiesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

          const propertyGridContainer =
            document.getElementById("propertyGrid");
          propertyGridContainer.innerHTML = ""; // Clear loading message

          if (properties.length === 0) {
            propertyGridContainer.innerHTML =
              '<p class="text-center text-gray-600 col-span-full py-8">No recommended properties found at the moment.</p>';
            return;
          }

          properties.forEach((property) => {
            const propertyCard = `
              <div class="property-card bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden transform hover:scale-105 transition-transform duration-200">
                <img
                  src="${
                    property.imageUrl ||
                    "https://placehold.co/400x250/22C55E/FFFFFF?text=Property"
                  }"
                  alt="${property.title || "Property Image"}"
                  class="property-image w-full h-48 object-cover"
                />
                <div class="property-details p-4 flex flex-col justify-between h-[calc(100%-12rem)]">
                  <div>
                    <div class="property-price text-xl font-bold text-green-600 mb-1">P${
                      property.price
                    }/month</div>
                    <h3 class="property-title text-lg font-semibold text-gray-800 mb-1">${
                      property.title || "Unknown Property"
                    }</h3>
                    <p class="property-location text-gray-600 text-sm mb-3">${
                      property.location || "Unknown Location"
                    }</p>
                    <div class="property-features flex flex-wrap gap-x-4 gap-y-2 text-gray-700 text-sm">
                      <span class="flex items-center"><i class="fas fa-bed text-gray-500 mr-1"></i> ${
                        property.beds || "N/A"
                      } Beds</span>
                      <span class="flex items-center"><i class="fas fa-bath text-gray-500 mr-1"></i> ${
                        property.baths || "N/A"
                      } Bath</span>
                      <span class="flex items-center"><i class="fas fa-ruler-combined text-gray-500 mr-1"></i> ${
                        property.sqft || "N/A"
                      } sqft</span>
                    </div>
                  </div>
                  <div class="property-actions flex space-x-2 mt-4">
                    <button class="btn btn-primary flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-all duration-200">
                      <i class="fas fa-eye mr-2"></i> View Details
                    </button>
                    <button class="btn btn-secondary bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg shadow-md transition-all duration-200">
                      <i class="fas fa-heart"></i> Save
                    </button>
                  </div>
                </div>
              </div>
            `;
            propertyGridContainer.insertAdjacentHTML("beforeend", propertyCard);
          });
        } catch (error) {
          console.error("Failed to fetch properties from Firebase:", error);
          document.getElementById("propertyGrid").innerHTML =
            '<p class="text-center text-gray-600 col-span-full py-8">Error loading properties. Please try again later.</p>';
        }
      }

      async function fetchReviews() {
        // Example: Fetch reviews from a 'reviews' collection in Firestore
        try {
          const reviewsSnapshot = await db.collection("reviews").get();
          const reviews = reviewsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          console.log("Fetched reviews from Firebase:", reviews);
          // You might display these in a separate section or modal
        } catch (error) {
          console.error("Failed to fetch reviews from Firebase:", error);
        }
      }

      // --- Logout Function (Firebase specific) ---
      document.getElementById('logoutBtn').addEventListener('click', async (event) => {
        event.preventDefault();
        try {
          await auth.signOut();
          window.location.href = "index.html"; // Redirect to home/login page after logout
        } catch (error) {
          console.error("Error signing out:", error);
          alert("Failed to log out. Please try again.");
        }
      });

      document.getElementById('headerLogoutBtn').addEventListener('click', async (event) => {
        event.preventDefault();
        try {
          await auth.signOut();
          window.location.href = "index.html"; // Redirect to home/login page after logout
        } catch (error) {
          console.error("Error signing out:", error);
          alert("Failed to log out. Please try again.");
        }
      });

      // --- Review Form Submission (Firebase specific) ---
      if (reviewForm) {
          reviewForm.addEventListener("submit", async (event) => {
            event.preventDefault();
            const reviewText = document.getElementById("reviewText").value;

            // Ensure user is logged in before submitting review
            const user = auth.currentUser;
            if (!user) {
                alert("You must be logged in to submit a review.");
                return;
            }

            try {
                // Add review to Firestore 'reviews' collection
                await db.collection("reviews").add({
                    userId: user.uid,
                    rating: currentRating,
                    reviewText: reviewText,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp() // Use server timestamp
                });

                reviewFormSuccess.classList.remove("hidden");
                // Optionally close modal after a short delay
                // setTimeout(closeReviewModal, 2000);
            } catch (err) {
                console.error("Error submitting review to Firebase:", err);
                alert("Error submitting review. Please try again.");
            }
          });
        }
    </script>
    <div class="flex flex-grow bg-gray-100">
      <aside
        class="w-64 bg-white shadow-lg p-6 flex flex-col rounded-r-xl md:rounded-r-none"
      >
        <div class="sidebar-header text-center mb-8">
          <img
            src="https://placehold.co/80x80/16A34A/FFFFFF?text=S"
            alt="Profile"
            class="profile-image w-20 h-20 rounded-full mx-auto mb-3 object-cover border-4 border-green-200"
          />
          <h2 class="text-xl font-semibold text-gray-800" id="sidebarWelcome">
            Welcome, Student
          </h2>
        </div>
        <ul class="sidebar-menu flex-grow space-y-2">
          <li>
            <a
              href="#"
              class="flex items-center p-3 rounded-lg text-green-700 bg-green-50 font-medium hover:bg-green-100 transition-colors duration-200"
              ><i class="fas fa-home mr-3"></i> Dashboard</a
            >
          </li>
          <li>
            <a
              href="marketplace.html"
              class="flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200"
              ><i class="fas fa-search mr-3"></i> Find Properties</a
            >
          </li>
          <li>
            <a
              href="saved-properties.html"
              class="flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200"
              ><i class="fas fa-heart mr-3"></i> Saved Properties</a
            >
          </li>
          <li>
            <a
              href="viewings.html"
              class="flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200"
              ><i class="fas fa-calendar mr-3"></i> Viewings</a
            >
          </li>
          <li>
            <a
              href="messages.html"
              class="flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200"
              ><i class="fas fa-envelope mr-3"></i> Messages</a
            >
          </li>
          <li>
            <a
              href="user-profile.html"
              class="flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200"
              ><i class="fas fa-user mr-3"></i> Profile</a
            >
          </li>
          <li>
            <a
              href="settings.html"
              class="flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200"
              ><i class="fas fa-cog mr-3"></i> Settings</a
            >
          </li>
          <li class="mt-auto pt-4">
            <a
              href="index.html"
              id="logoutBtn"
              class="flex items-center p-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors duration-200"
              ><i class="fas fa-sign-out-alt mr-3"></i> Logout</a
            >
          </li>
        </ul>
      </aside>

      <main class="main-content flex-grow p-6 overflow-y-auto">
        <div
          class="dashboard-header bg-white p-6 rounded-xl shadow-md mb-6 flex flex-col md:flex-row items-center justify-between gap-4"
        >
          <div class="search-container w-full md:w-2/3 flex flex-col gap-3">
            <div
              class="search-bar flex items-center border border-gray-300 rounded-lg p-2 bg-gray-50 focus-within:ring-2 focus-within:ring-green-300 transition-all duration-200"
            >
              <i class="fas fa-search text-gray-400 mr-2"></i>
              <input
                type="text"
                class="search-input flex-grow bg-transparent outline-none text-gray-800 placeholder-gray-400"
                placeholder="Search properties in Gaborone..."
                id="propertySearchInput"
              />
            </div>
            <div
              class="search-filters grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3"
              id="searchFilters"
            >
              <select
                class="filter-select p-2 border border-gray-300 rounded-lg bg-white text-gray-700 focus:ring-2 focus:ring-green-300 focus:border-green-300 transition-all duration-200"
              >
                <option value="">All Amenities</option>
                <option value="wifi">WiFi</option>
                <option value="parking">Parking</option>
                <option value="furnished">Furnished</option>
                <option value="security">Security</option>
                <option value="laundry">Laundry</option>
              </select>
              <select
                class="filter-select p-2 border border-gray-300 rounded-lg bg-white text-gray-700 focus:ring-2 focus:ring-green-300 focus:border-green-300 transition-all duration-200"
              >
                <option value="">All Areas</option>
                <option value="ub">Near UB</option>
                <option value="baisago">Near Baisago</option>
                <option value="botho">Near Botho</option>
                <option value="riverwalk">Riverwalk</option>
                <option value="gamecity">Game City</option>
              </select>
              <select
                class="filter-select p-2 border border-gray-300 rounded-lg bg-white text-gray-700 focus:ring-2 focus:ring-green-300 focus:border-green-300 transition-all duration-200"
              >
                <option value="">Budget Range</option>
                <option value="0-2000">P0 - P2,000</option>
                <option value="2000-4000">P2,000 - P4,000</option>
                <option value="4000-6000">P4,000 - P6,000</option>
                <option value="6000+">P6,000+</option>
              </select>
              <select
                class="filter-select p-2 border border-gray-300 rounded-lg bg-white text-gray-700 focus:ring-2 focus:ring-green-300 focus:border-green-300 transition-all duration-200"
              >
                <option value="">Property Condition</option>
                <option value="new">New</option>
                <option value="renovated">Renovated</option>
                <option value="good">Good</option>
                <option value="needs-work">Needs Work</option>
              </select>
            </div>
          </div>
          <div class="header-actions flex items-center space-x-4">
            <div class="notifications-container relative">
              <div
                class="notifications cursor-pointer relative"
                id="notificationToggle"
              >
                <i
                  class="fas fa-bell text-gray-600 text-xl hover:text-green-600 transition-colors duration-200"
                ></i>
                <span
                  class="notification-badge absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center"
                  id="notificationBadge"
                  >0</span
                >
              </div>
              <div
                class="notification-dropdown absolute right-0 mt-3 w-72 bg-white rounded-lg shadow-xl z-10 hidden"
                id="notificationDropdown"
              >
                <div class="notification-tabs flex border-b border-gray-200">
                  <div
                    class="notification-tab active flex-1 text-center p-3 cursor-pointer text-green-700 font-semibold border-b-2 border-green-600"
                    data-tab="messages"
                    href="messages.html"
                  >
                    Messages
                  </div>
                  <div
                    class="notification-tab flex-1 text-center p-3 cursor-pointer text-gray-600 hover:text-gray-800"
                    data-tab="properties"
                  >
                    Properties
                  </div>
                </div>
                <div
                  class="notification-list p-3 max-h-60 overflow-y-auto"
                  id="notificationList"
                >
                  <p class="text-center text-gray-500 py-4">
                    No new notifications.
                  </p>
                  </div>
              </div>
            </div>
            <div class="profile-menu relative">
              <img
                src="https://placehold.co/40x40/16A34A/FFFFFF?text=S"
                alt="Profile"
                class="profile-image-small w-10 h-10 rounded-full object-cover cursor-pointer border-2 border-green-300"
                id="profileMenuToggle"
              />
              <div
                class="profile-dropdown absolute right-0 mt-3 w-48 bg-white rounded-lg shadow-xl z-10 hidden"
              >
                <a
                  href="user-profile.html"
                  class="flex items-center p-3 text-gray-700 hover:bg-gray-100 rounded-t-lg transition-colors duration-200"
                  ><i class="fas fa-user mr-3"></i> Profile</a
                >
                <a
                  href="settings.html"
                  class="flex items-center p-3 text-gray-700 hover:bg-gray-100 transition-colors duration-200"
                  ><i class="fas fa-cog mr-3"></i> Settings</a
                >
                <a
                  href="#"
                  id="headerLogoutBtn"
                  class="flex items-center p-3 text-red-600 hover:bg-red-50 rounded-b-lg transition-colors duration-200"
                  ><i class="fas fa-sign-out-alt mr-3"></i> Logout</a
                >
              </div>
            </div>
          </div>
        </div>
        <div
          class="dashboard-cards grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"
          id="dashboardCards"
        >
          <div
            class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center animate-pulse"
          >
            <div class="h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
            <div class="h-10 bg-gray-300 rounded w-1/2 mx-auto"></div>
          </div>
          <div
            class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center animate-pulse"
          >
            <div class="h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
            <div class="h-10 bg-gray-300 rounded w-1/2 mx-auto"></div>
          </div>
          <div
            class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center animate-pulse"
          >
            <div class="h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
            <div class="h-10 bg-gray-300 rounded w-1/2 mx-auto"></div>
          </div>
          <div
            class="dashboard-card bg-white p-6 rounded-xl shadow-md text-center animate-pulse"
          >
            <div class="h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
            <div class="h-10 bg-gray-300 rounded w-1/2 mx-auto"></div>
          </div>
          </div>
        <div class="property-listings bg-white p-6 rounded-xl shadow-md">
          <div
            class="property-listings-header flex items-center justify-between mb-6"
          >
            <h2 class="text-2xl font-bold text-gray-800">
              Recommended Properties
              <span
                class="location-badge bg-green-100 text-green-700 text-sm font-medium px-3 py-1 rounded-full ml-2"
                >Gaborone</span
              >
            </h2>
            <a
              href="marketplace.html"
              class="text-green-600 hover:text-green-800 font-medium transition-colors duration-200"
              >View All <i class="fas fa-arrow-right ml-1 text-sm"></i
            ></a>
          </div>
          <div
            class="property-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
            id="propertyGrid"
          >
            <div
              class="property-card bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden animate-pulse"
            >
              <div class="w-full h-48 bg-gray-200"></div>
              <div class="p-4">
                <div class="h-5 bg-gray-200 rounded w-3/4 mb-2"></div>
                <div class="h-4 bg-gray-200 rounded w-1/2 mb-3"></div>
                <div class="h-4 bg-gray-200 rounded w-1/3 mb-4"></div>
                <div class="flex space-x-2">
                  <div class="h-10 bg-gray-200 rounded w-2/3"></div>
                  <div class="h-10 bg-gray-200 rounded w-1/3"></div>
                </div>
              </div>
            </div>
            <div
              class="property-card bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden animate-pulse"
            >
              <div class="w-full h-48 bg-gray-200"></div>
              <div class="p-4">
                <div class="h-5 bg-gray-200 rounded w-3/4 mb-2"></div>
                <div class="h-4 bg-gray-200 rounded w-1/2 mb-3"></div>
                <div class="h-4 bg-gray-200 rounded w-1/3 mb-4"></div>
                <div class="flex space-x-2">
                  <div class="h-10 bg-gray-200 rounded w-2/3"></div>
                  <div class="h-10 bg-gray-200 rounded w-1/3"></div>
                </div>
              </div>
            </div>
            <div
              class="property-card bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden animate-pulse"
            >
              <div class="w-full h-48 bg-gray-200"></div>
              <div class="p-4">
                <div class="h-5 bg-gray-200 rounded w-3/4 mb-2"></div>
                <div class="h-4 bg-gray-200 rounded w-1/2 mb-3"></div>
                <div class="h-4 bg-gray-200 rounded w-1/3 mb-4"></div>
                <div class="flex space-x-2">
                  <div class="h-10 bg-gray-200 rounded w-2/3"></div>
                  <div class="h-10 bg-gray-200 rounded w-1/3"></div>
                </div>
              </div>
            </div>
            </div>
        </div>
      </main>
    </div>
    <footer class="footer bg-gray-800 text-white p-8 mt-auto">
      <div
        class="footer-container max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8"
      >
        <div class="footer-section">
          <h3 class="text-xl font-semibold mb-4 text-green-300">Quick Links</h3>
          <ul class="footer-links space-y-2">
            <li>
              <a
                href="index.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-home mr-2"></i> Home</a
              >
            </li>
            <li>
              <a
                href="student-dashboard.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-user mr-2"></i> Dashboard</a
              >
            </li>
            <li>
              <a
                href="contact.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-envelope mr-2"></i> Contact Us</a
              >
            </li>
          </ul>
        </div>
        <div class="footer-section">
          <h3 class="text-xl font-semibold mb-4 text-green-300">
            Help & Support
          </h3>
          <ul class="footer-links space-y-2">
            <li>
              <a
                href="faq.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-question-circle mr-2"></i> FAQ</a
              >
            </li>
            <li>
              <a
                href="contact.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-headset mr-2"></i> Support</a
              >
            </li>
            <li>
              <a
                href="reset-password.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-key mr-2"></i> Reset Password</a
              >
            </li>
          </ul>
        </div>
        <div class="footer-section">
          <h3 class="text-xl font-semibold mb-4 text-green-300">Legal</h3>
          <ul class="footer-links space-y-2">
            <li>
              <a
                href="terms.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-file-contract mr-2"></i> Terms of Service</a
              >
            </li>
            <li>
              <a
                href="privacy.html"
                class="flex items-center text-gray-300 hover:text-white transition-colors duration-200"
                ><i class="fas fa-shield-alt mr-2"></i> Privacy Policy</a
              >
            </li>
          </ul>
        </div>
      </div>
      <div
        class="footer-bottom text-center text-gray-400 mt-8 pt-4 border-t border-gray-700"
      >
        <p>&copy; 2025 InRent. All rights reserved.</p>
      </div>
    </footer>
    <div
      class="modal fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden"
      id="review-modal"
    >
      <div
        class="modal-content bg-white rounded-xl shadow-2xl p-6 w-full max-w-lg relative transform scale-95 opacity-0 transition-all duration-300 ease-out"
        style="max-width: 550px"
      >
        <span
          class="modal-close absolute top-3 right-3 text-gray-400 hover:text-gray-600 text-3xl font-light cursor-pointer"
          >&times;</span
        >
        <h3
          id="reviewModalTitle"
          class="text-2xl font-bold text-gray-800 mb-6 text-center"
        >
          Write a Review
        </h3>
        <form id="reviewForm" class="space-y-6">
          <div class="form-group">
            <label class="block text-gray-700 text-sm font-medium mb-2"
              >Your Rating:</label
            >
            <div
              class="rating-stars flex justify-center space-x-1 text-yellow-400 text-2xl"
              id="reviewRatingStars"
            >
              <i class="fas fa-star cursor-pointer hover:text-yellow-500"></i>
              <i class="fas fa-star cursor-pointer hover:text-yellow-500"></i>
              <i class="fas fa-star cursor-pointer hover:text-yellow-500"></i>
              <i class="far fa-star cursor-pointer hover:text-yellow-500"></i>
              <i class="far fa-star cursor-pointer hover:text-yellow-500"></i>
            </div>
          </div>
          <div class="form-group">
            <label
              for="reviewText"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Your Review:</label
            >
            <textarea
              id="reviewText"
              required
              rows="4"
              class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200"
              placeholder="Share your experience..."
            ></textarea>
          </div>
          <button
            type="submit"
            class="btn w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105"
          >
            Submit Review
          </button>
          <div
            class="success-message text-green-600 text-center mt-4 hidden"
            id="reviewFormSuccess"
          >
            Review submitted successfully!
          </div>
        </form>
      </div>
    </div>
    <script>
      // Basic JS for dropdowns and modal (for demonstration)
      document.addEventListener("DOMContentLoaded", () => {
        // Notification Dropdown
        const notificationToggle =
          document.getElementById("notificationToggle");
        const notificationDropdown = document.getElementById(
          "notificationDropdown"
        );

        if (notificationToggle && notificationDropdown) {
          notificationToggle.addEventListener("click", () => {
            notificationDropdown.classList.toggle("hidden");
          });

          document.addEventListener("click", (event) => {
            if (
              !notificationToggle.contains(event.target) &&
              !notificationDropdown.contains(event.target)
            ) {
              notificationDropdown.classList.add("hidden");
            }
          });
        }

        // Profile Menu Dropdown
        const profileMenuToggle = document.getElementById("profileMenuToggle");
        const profileDropdown = document.querySelector(
          ".profile-menu .profile-dropdown"
        );

        if (profileMenuToggle && profileDropdown) {
          profileMenuToggle.addEventListener("click", (event) => {
            event.stopPropagation(); // Prevent immediate closing from document click
            profileDropdown.classList.toggle("hidden");
          });

          document.addEventListener("click", (event) => {
            if (
              !profileMenuToggle.contains(event.target) &&
              !profileDropdown.contains(event.target)
            ) {
              profileDropdown.classList.add("hidden");
            }
          });
        }

        // Review Modal
        const reviewModal = document.getElementById("review-modal");
        const modalCloseBtn = reviewModal
          ? reviewModal.querySelector(".modal-close")
          : null;
        const reviewForm = document.getElementById("reviewForm");
        const reviewFormSuccess = document.getElementById("reviewFormSuccess");
        const reviewRatingStars = document.getElementById("reviewRatingStars");
        let currentRating = 0;

        // Function to open the modal (you'd call this from a button click)
        function openReviewModal() {
          if (reviewModal) {
            reviewModal.classList.remove("hidden");
            setTimeout(() => {
              reviewModal
                .querySelector(".modal-content")
                .classList.remove("opacity-0", "scale-95");
              reviewModal
                .querySelector(".modal-content")
                .classList.add("opacity-100", "scale-100");
            }, 10); // Small delay for transition
          }
        }

        // Function to close the modal
        function closeReviewModal() {
          if (reviewModal) {
            reviewModal
              .querySelector(".modal-content")
              .classList.remove("opacity-100", "scale-100");
            reviewModal
              .querySelector(".modal-content")
              .classList.add("opacity-0", "scale-95");
            setTimeout(() => {
              reviewModal.classList.add("hidden");
              reviewFormSuccess.classList.add("hidden"); // Hide success message on close
              reviewForm.reset(); // Reset form
              currentRating = 0; // Reset rating
              updateStarRating();
            }, 300); // Match transition duration
          }
        }

        if (modalCloseBtn) {
          modalCloseBtn.addEventListener("click", closeReviewModal);
        }

        if (reviewModal) {
          reviewModal.addEventListener("click", (event) => {
            if (event.target === reviewModal) {
              // Close if clicked outside modal content
              closeReviewModal();
            }
          });
        }

        // Example: Open modal from a dashboard card (for testing)
        // You'd typically trigger this from a 'Write Review' button or similar
        const messagesCard = document.querySelector(
          ".dashboard-card:nth-child(3)"
        ); // Assuming messages card triggers review modal for demo
        if (messagesCard) {
          messagesCard.addEventListener("click", openReviewModal);
        }

        // Star rating functionality
        function updateStarRating() {
          if (reviewRatingStars) {
            Array.from(reviewRatingStars.children).forEach((star, index) => {
              if (index < currentRating) {
                star.classList.remove("far");
                star.classList.add("fas");
              } else {
                star.classList.remove("fas");
                star.classList.add("far");
              }
            });
          }
        }

        if (reviewRatingStars) {
          Array.from(reviewRatingStars.children).forEach((star, index) => {
            star.addEventListener("click", () => {
              currentRating = index + 1;
              updateStarRating();
            });
          });
        }
      });
    </script>
  </body>
</html>